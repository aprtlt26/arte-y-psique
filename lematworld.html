
function startAudioContext() {
    if (!audioCtx) {
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        oscilador = audioCtx.createOscillator();
        gainNode = audioCtx.createGain();

        // Crear delay y configurar
        const delay = audioCtx.createDelay(1.0);
        const delayGain = audioCtx.createGain();
        delay.delayTime.value = 0.2; // Tiempo de delay inicial
        delayGain.gain.value = 0.5;  // Ganancia del delay para controlar la intensidad del eco

        delay.connect(delayGain);
        delayGain.connect(delay);
        delayGain.connect(audioCtx.destination); // Enviar eco al destino

        // Conectar el oscilador a gainNode y al delay
        oscilador.connect(gainNode);
        gainNode.connect(audioCtx.destination);
        gainNode.connect(delay); // También enviamos el sonido al delay

        oscilador.start();
    }
}








</script>

<script>
    // Instancia de p5 para el árbol
    let sketch2 = function(p) {
  let asciiCat = `
  
         
  ☁☁ ☁ 
  

  `;

  p.setup = function() {
    p.createCanvas(710, 200);
    p.textSize(32);
    p.fill(255);
    x = p.random(p.width - 100); // Coordenada inicial x
        y = p.random(p.height - 100); // Coordenada inicial y
    };

  p.draw = function() {
    p.background(0);

    let x = p.random(p.width - 100); // Asegura espacio para el gato
    let y = p.random(p.height - 250); // Asegura espacio para el gato

    // Dibuja el gato en el canvas en la posición aleatoria
    p.text(asciiCat, x, y,x);

  };

  p.mouseClicked = function() {
    p.clear(); // Limpia el canvas
    p.draw(); // Dibuja un nuevo gato
  };
};

new p5(sketch2, 'tree-sketch-container');
    </script>

<script>
    // Define la nueva instancia de p5.js para el sketch de las barras de color
    new p5(function(p) {
  const barSize = 50; // Tamaño de cada "barra" cuadrada
  let lastBarIndex = -1; // Último índice de la barra dibujada

  p.setup = function() {
    let canvas = p.createCanvas(90, 200); // Dimensiones del canvas
    canvas.parent('color-bar-sketch-container'); // Asigna el contenedor
    canvas.style('opacity', '0.2'); // Establece la opacidad del canvas

    p.colorMode(p.HSB, p.width, p.width, p.width); // Modo de color HSB basado en el ancho
    p.noStroke();
    p.background(0);
  };

  p.draw = function() {
    let mouseXAdjusted = p.mouseX - (p.width / 2); // Ajusta mouseX para que el centro sea 0
    let mouseYAdjusted = p.mouseY - (p.height / 2); // Ajusta mouseY para que el centro sea 0
    // Calcula la "barra" basada en la distancia más corta al eje X o Y desde el centro
    let whichBarIndex = p.int(p.min(p.abs(mouseXAdjusted), p.abs(mouseYAdjusted)) / barSize);
    
    if (whichBarIndex !== lastBarIndex) {
      // Calcula la posición inicial de la barra cuadrada
      let startX = (p.width / 2) - whichBarIndex * barSize;
      let startY = (p.height / 2) - whichBarIndex * barSize;

      for (let i = 0; i <= whichBarIndex; i++) {
        // Dibuja cada "barra" cuadrada a lo largo de la diagonal
        let x = startX + i * barSize;
        let y = startY + i * barSize;
        
        p.fill(p.mouseX, p.width, p.width); // Color basado en la posición del ratón
        p.rect(x, y, barSize, barSize); // Dibuja el rectángulo
      }
      lastBarIndex = whichBarIndex;
    }
  };

}, 'color-bar-sketch-container'); // Asegúrate de que este ID coincida con el del contenedor

    </script>
    
    
   <script>
new p5(function(p) {
    const barHeight = 20; // La altura de cada barra será de 20
    let lastBar = -1; // Última barra actualizada
  
    p.setup = function() {
      let canvas = p.createCanvas(220, 200);
      canvas.parent('color-bar-sketch-container');
      canvas.style('opacity', '0.5');
  
      p.colorMode(p.HSB, p.width, p.width, p.width);
      p.noStroke();
      p.background(0);
    };
  
    p.draw = function() {
      let whichBar = p.int(p.mouseY / barHeight);
      if (whichBar !== lastBar) {
        let barY = whichBar * barHeight;
        p.fill(p.mouseX, p.width, p.width);
        p.rect(0, barY, p.width, barHeight);
        lastBar = whichBar;
      }
  
      // Glitch effect
      if (p.random() < 0.2) { // 10% chance of glitch effect
        applyGlitch(p);
      }
    };
  
    function applyGlitch(p) {
      // Escoge un número aleatorio de barras para aplicar el glitch
      const glitchBars = p.int(p.random(1, 7));
      for (let i = 0; i < glitchBars; i++) {
        const glitchY = p.int(p.random(p.height / barHeight)) * barHeight;
        const glitchHeight = p.random(barHeight / 4, barHeight * 5);
        const glitchWidth = p.random(p.width * 0.1, p.width);
        const glitchX = p.random(p.width - glitchWidth);
        const r = p.random(255);
        const g = p.random(255);
        const b = p.random(255);
  
        p.fill(r, g, b);
        p.rect(glitchX, glitchY, glitchWidth, glitchHeight);
      }
    }
  
  }, 'color-bar-sketch-container');
  
</script>

<script>
   document.addEventListener('keydown', function(event) {
    if (!audioCtx) startAudioContext(); // Inicia el contexto de audio si aún no está activo

    switch(event.key) {
        case 's':
        case 'S':
            // Alternar audio del sol
            togglePlay('ascii-sol', 'ambient.wav');
            break;
        case 'l':
        case 'L':
            // Alternar audio de la luna
            togglePlay('ascii-luna', '0S.wav');
            break;
        case ' ':
            // Mostrar/ocultar el gato ASCII y gestionar ruido blanco
            toggleAsciiCatAndWhiteNoise();
            event.preventDefault(); // Evitar que la barra espaciadora haga scroll

            break;
        case 'ArrowUp':
        case 'ArrowDown':
        case 'ArrowLeft':
        case 'ArrowRight':
            // Manejar el movimiento del cursor con flechas
            handleArrowKeys(event.key);
            break;
    }
});


function moverYMostrarGatoAscii(mostrar) {
    console.log("moverYMostrarGatoAscii: mostrar =", mostrar); // Depuración
    const asciiCatElement = document.getElementById('ascii-cat');
    if (mostrar) {
        const newX = Math.random() * (window.innerWidth - asciiCatElement.offsetWidth);
        const newY = Math.random() * (window.innerHeight - asciiCatElement.offsetHeight);
        asciiCatElement.style.left = `${newX}px`;
        asciiCatElement.style.top = `${newY}px`;
        asciiCatElement.style.display = 'block';
    } else {
        asciiCatElement.style.display = 'none';
    }
}


function toggleAsciiCatAndWhiteNoise() {
    const asciiCatElement = document.getElementById('ascii-cat');
    // Verificar si el gato está visible basado en el estilo 'display'
    const isVisible = asciiCatElement.style.display === 'block';

    if (isVisible) {
        // Detener el ruido blanco y ocultar el gato ASCII
        if (whiteNoiseSource) {
            whiteNoiseSource.disconnect();
            whiteNoiseSource = null;
        }
        moverYMostrarGatoAscii(false); // Ocultar el gato ASCII
    } else {
        // Generar ruido blanco y mostrar el gato ASCII
        generarRuidoBlanco(22); // Suponemos que la función ya mueve y muestra el gato ASCII
    }
}





let catVisible = false; // Estado de visibilidad del gato

document.getElementById('ascii-cat').addEventListener('click', function() {

    generarRuidoBlanco();  // Iniciar ruido blanco al clic
    catVisible = !catVisible;
    this.style.display = catVisible ? 'block' : 'true';
});


document.addEventListener('keydown', function(event) {
    if (event.key === ' ') {
        catVisible = !catVisible; // Alternar visibilidad con barra espaciadora
        document.getElementById('ascii-cat').style.display = catVisible ? 'block' : 'none';
        event.preventDefault(); // Evitar el desplazamiento de la página
    }
});






// Evento para controlar la ganancia con el movimiento del mouse o touch
document.body.addEventListener('mousemove', handleMovement);
document.body.addEventListener('touchmove', handleMovement);

function handleMovement(event) {
    let x, y;
    if (event.touches) {
        x = event.touches[0].clientX;
        y = event.touches[0].clientY;
    } else {
        x = event.clientX;
        y = event.clientY;
    }

    // Escalar la amplitud del ruido blanco según la posición vertical
    let newGain = Math.max(0, Math.min(1, (window.innerHeight - y) / window.innerHeight));
    gainNode.gain.value = newGain;

    // Aquí puedes añadir la lógica para cambiar algún otro parámetro con x si lo deseas
}

    
    </script>
    <script>
       
        let rainSketch = function(p) {
            let raindrops = [];
    
            p.setup = function() {
                p.createCanvas(p.windowWidth, p.windowHeight);
                p.frameRate(100);
            };
    
            p.draw = function() {
                p.clear();
                for (let i = raindrops.length - 1; i >= 0; i--) {
                    raindrops[i].update();
                    raindrops[i].display();
                    if (raindrops[i].isOffScreen()) {
                        raindrops.splice(i, 1);
                    }
                }
    
                if (p.frameCount % 2 === 0) {
                    raindrops.push(new Raindrop(p));
                }
            };
    
            class Raindrop {
                constructor(p) {
                    this.p = p;
                    this.x = p.random(p.width);
                    this.y = 0;
                    this.z = p.random(0, 20);
                    this.len = p.map(this.z, 0, 20, 10, 20);
                    this.yspeed = p.map(this.z, 0, 20, 4, 10);
                }
    
                update() {
                    this.y += this.yspeed;
                    let grav = p.map(this.z, 0, 20, 0.01, 0.2);
                    this.yspeed += grav;
                }
    
                display() {
                    p.stroke(138, 43, 300);
                    p.line(this.x, this.y, this.x, this.y + this.len);
                }
    
                isOffScreen() {
                    return this.y > this.p.height;
                }
            }
        };
    
        new p5(rainSketch, 'rain-sketch-container');
    </script>
</body>
</html>










